---
import LogoPrimary from "../assets/icons/logo-primary.svg";
import Logo from "../assets/icons/logo.svg";
import Button from "../components/ui/Button.astro";
import LanguageSwitcher from "../components/ui/LanguageSwitcher.astro";

const { white = false, defaultLocale = "en" } = Astro.props;

const rawBase = Astro.site?.pathname || "/";
const root = rawBase.endsWith("/") ? rawBase.slice(0, -1) : rawBase;

const { pathname } = Astro.url;
const isPL =
  pathname === `${root}/pl` ||
  pathname.startsWith(`${root}/pl/`) ||
  defaultLocale === "pl";

const locBase = isPL ? `${root}/pl` : `${root}`;

const homeHref = `${locBase}/`;
const blogHref = `${locBase}/blog/`;
const ctaHref = `${locBase}/#about`;
---

<header class={`container-fluid menu ${white ? "menu--white" : ""}`}>
  <div class="container menu-container">
    <a href={homeHref}>
      {
        white ? (
          <img src={LogoPrimary.src} alt="Limulus logo" class="menu-logo" />
        ) : (
          <img src={Logo.src} alt="Limulus logo" class="menu-logo" />
        )
      }
    </a>
    <div class="menu-right">
      <LanguageSwitcher defaultLocale={isPL ? "pl" : "en"} />
      <a href={blogHref} class="p--big menu-blog">Blog</a>
      {
        white ? (
          <Button label={isPL ? "Zapisz się" : "Register"} href={ctaHref} />
        ) : (
          <Button
            label={isPL ? "Zapisz się" : "Register"}
            href={ctaHref}
            white
          />
        )
      }
    </div>
  </div>
</header>

<header class={`container-fluid mobile-menu ${white ? "menu--white" : ""}`}>
  <div class="menu-top container">
    <a href={homeHref}>
      <img src={Logo.src} alt="Limulus logo" class="menu-logo" />
    </a>
    <a href={blogHref} class="p--big menu-blog">Blog</a>
    <LanguageSwitcher defaultLocale={isPL ? "pl" : "en"} />
  </div>
</header>

<div class="container-fluid menu-bottom">
  <Button
    label={isPL ? "Zapisz się" : "Register"}
    href={ctaHref}
    class="cta-button"
  />
</div>
